---
title: Export and Convert Snapshots
---

In this example, you will: 

1. Create an export snapshot
2. Poll for export completion
3. Download the resulting export file
4. Convert the export to a specified format (optional and only if an export type is specified)
5. Poll for conversion completion
6. Download the resulting converted file

When running this script, you can optionally provide an argument for the export type (CSV, COCO, JSON, etc.) to convert to. For example:

`python export_snapshots.py CSV`

Read more about supported export formats in the [Label Studio documentation](https://labelstud.io/guide/export).

For information on finding your API key and base URL, see [Authenticate and Connect to the API](../../api-reference/introduction/getting-started#authenticate-and-connect-to-the-api).

```py
# Define the URL where Label Studio is accessible
LABEL_STUDIO_URL = 'YOUR_BASE_URL'
# API key is available at the Account & Settings page in Label Studio UI
LABEL_STUDIO_API_KEY = 'YOUR_API_KEY'
PROJECT_ID=1    # replace with your project ID 

import sys
import time
from pathlib import Path
import logging

from label_studio_sdk import LabelStudio
from label_studio_sdk.core.api_error import ApiError

client = LabelStudio(base_url=LABEL_STUDIO_URL, api_key=LABEL_STUDIO_API_KEY)

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("export_snapshots")


def export_and_download_snapshot():
    """Export project JSON snapshot

    This example demonstrates how to:
    - Create an export snapshot
    - Poll for completion
    - Download the resulting file
    """

    # Initialize v2 client
    client = LabelStudio(base_url=LABEL_STUDIO_URL, api_key=LABEL_STUDIO_API_KEY)

    # Fetch project and optional first view id
    client.projects.get(id=PROJECT_ID)
    views = client.views.list(project=PROJECT_ID)
    {"view": views[0].id} if views else None

    # Create export snapshot
    create_kwargs = {
        "title": "Export SDK Snapshot",
        # task_filter_options follows API schema; pass only if a view is available
        # "task_filter_options": {"view": task_filter_options["view"]} if task_filter_options else None,
    }
    # Remove None keys to avoid sending them
    create_kwargs = {k: v for k, v in create_kwargs.items() if v is not None}

    export_job = client.projects.exports.create(id=PROJECT_ID, **create_kwargs)
    export_id = export_job.id
    logger.info(f"Created export snapshot: id={export_id}, status={export_job.status}")

    # Poll until completed or failed
    start = time.time()
    timeout_sec = 300
    logger.info("Waiting for export snapshot to complete...")
    while True:
        job = client.projects.exports.get(id=PROJECT_ID, export_pk=export_id)
        elapsed = int(time.time() - start)
        logger.info(f"Export status: {job.status} (elapsed {elapsed}s)")
        if job.status in ("completed", "failed"):
            break
        if time.time() - start > timeout_sec:
            raise TimeoutError(
                f"Export job timed out (id={export_id}, status={job.status})"
            )
        time.sleep(1.0)

    if job.status == "failed":
        raise ApiError(status_code=500, body=f"Export failed: {job}")

    # Download export as JSON to local file
    out_dir = Path(".")
    out_dir.mkdir(parents=True, exist_ok=True)
    out_path = out_dir / f"project_{PROJECT_ID}_export_{export_id}.json"

    with open(out_path, "wb") as f:
        for chunk in client.projects.exports.download(
            id=PROJECT_ID,
            export_pk=export_id,
            export_type="JSON",
            request_options={"chunk_size": 1024},
        ):
            f.write(chunk)

    logger.info(f"Export completed. File saved to: {out_path}")
    return export_id


def convert_snapshot(export_type: str, export_id: str = None):
    """Convert the project export JSON snapshot to a specified format and download it.

    The conversion API is used to start a conversion on the Label Studio backend, then we poll export status
    until the specific converted format is completed, and finally download it.
    See docs: projects/exports/convert and projects/exports/list.

    Args:
        export_type: The type of export to convert to.
        export_id: The ID of the export to convert. If not provided, the latest export will be used.
    """
    client = LabelStudio(base_url=LABEL_STUDIO_URL, api_key=LABEL_STUDIO_API_KEY)

    # Get the latest export snapshot for the project
    exports = client.projects.exports.list(id=PROJECT_ID)
    if not exports:
        raise ApiError(
            status_code=404, body="No export snapshots found for the project"
        )
    exports = sorted(exports, key=lambda e: e.created_at, reverse=True)
    export = exports[0]
    export_id = export.id if not export_id else export_id

    # Start conversion
    conv = client.projects.exports.convert(
        export_pk=export_id, id=PROJECT_ID, export_type=export_type
    )
    converted_format_id = conv.converted_format
    logger.info(
        f"Started conversion: export_id={export_id}, export_type={export_type}, converted_format_id={converted_format_id}"
    )

    # Poll converted format status
    start = time.time()
    timeout_sec = 300
    logger.info("Waiting for conversion to complete...")
    while True:
        cur = client.projects.exports.get(id=PROJECT_ID, export_pk=export_id)
        cf = None
        if cur.converted_formats:
            cf = next(
                (
                    c
                    for c in cur.converted_formats
                    if (converted_format_id and c.id == converted_format_id)
                    or (c.export_type == export_type)
                ),
                None,
            )
        status = getattr(cf, "status", None)
        elapsed = int(time.time() - start)
        logger.info(
            f"Conversion status: {status or 'pending'} (format {export_type}, elapsed {elapsed}s)"
        )
        if status in ("completed", "failed"):
            break
        if time.time() - start > timeout_sec:
            raise TimeoutError(
                f"Conversion timed out (export_id={export_id}, format={export_type}, status={status})"
            )
        time.sleep(1.0)

    if status == "failed":
        raise ApiError(
            status_code=500,
            body=f"Conversion failed (export_id={export_id}, format={export_type})",
        )

    # Download converted file using export_type param
    ext = "json" if export_type.upper().startswith("JSON") else export_type.lower()
    out_dir = Path(".")
    out_dir.mkdir(parents=True, exist_ok=True)
    out_path = out_dir / f"project_{PROJECT_ID}_export_{export_id}.{ext}"

    with open(out_path, "wb") as f:
        for chunk in client.projects.exports.download(
            id=PROJECT_ID,
            export_pk=export_id,
            export_type=export_type,
            request_options={"chunk_size": 1024},
        ):
            f.write(chunk)

    logger.info(f"Converted export downloaded. File saved to: {out_path}")


if __name__ == "__main__":

    export_id = export_and_download_snapshot()
    logger.info(f"Export ID: {export_id}")
    
    export_type = sys.argv[1] if len(sys.argv) > 1 else None
    if export_type and export_type != "JSON":
        logger.info(f"Converting export to {export_type} format")
        convert_snapshot(export_type, export_id)
```

